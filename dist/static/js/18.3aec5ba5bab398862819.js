webpackJsonp([18],{"5RCQ":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("rVsN"),n=a.n(s),i=a("iqp0");var r=a("Q3yb"),o={data:function(){return{labelPosition:"right",on_timeRules:[{validate:function(e){return!!e},message:"上线时间不能为空"}],nameRules:[{validate:function(e){return!!e},message:"业务系统名称不能为空"}],descriptionRules:[{validate:function(e){return!!e},message:"功能说明不能为空"}],formData:{id:"",on_time:"",status:1,description:"",name:""}}},props:{layerid:{type:String},layer_data:{type:[String,Object,Array],default:function(){return{}}},is_add:{type:Boolean,default:!0},dropDownData:{type:Object,default:function(){return{}}}},created:function(){this.is_add||this.getBusinessInfo(this.layer_data)},methods:{openDate:function(e){Object(r.a)(e,this)},submitEdit:function(){var e=this;this.$refs.assets_business_add.validate().then(function(t){t&&e.$isShowTip("assets","assets_business","确定保存吗？",function(){e.__editBusiness(e.formData)},e)})},submitAdd:function(){var e=this;this.$refs.assets_business_add.validate().then(function(t){t&&e.$isShowTip("assets","assets_business","确定添加吗？",function(){e.__addBusiness(e.formData).then(function(t){e.$layer.close(e.layerid)}).catch(function(e){console.log(e)})},e)})},submitSaveAdd:function(){var e=this;this.$refs.assets_business_add.validate().then(function(t){t&&e.$isShowTip("assets","assets_business","确定添加吗？",function(){e.__addBusiness(e.formData).then(function(t){e.$refs.assets_business_add.clear(),e.formData={id:"",on_time:"",status:1,description:"",name:""}}).catch(function(e){console.log(e)})},e)})},cancel:function(){var e=this;this.$isShowTip("assets","assets_business","确定取消吗？",function(){e.$layer.close(e.layerid)},this)},getBusinessInfo:function(e){this.formData.id=this.layer_data.id||"",this.formData.name=this.layer_data.name||"",this.formData.status=this.layer_data.status||1,this.formData.description=this.layer_data.description||"",this.formData.on_time=this.layer_data.on_time||""},__addBusiness:function(e){var t=this;return function(e){return Object(i.a)({url:"/software/add",data:e,type:"post"}).then(function(e){return n.a.resolve(e)}).catch(function(e){return n.a.reject(e)})}(e).then(function(e){return t.$message({type:"success",message:"添加成功"}),t.$parent.$refs.assets_business_table.reload(),n.a.resolve(e)}).catch(function(e){return n.a.reject(e)})},__editBusiness:function(e){var t=this;(function(e){return Object(i.a)({url:"/software/modify",data:e,type:"post"}).then(function(e){return n.a.resolve(e)}).catch(function(e){return n.a.reject(e)})})(e).then(function(e){t.$message({type:"success",message:"修改成功"}),t.$parent.$refs.assets_business_table.reload(),t.$layer.close(t.layerid)}).catch(function(e){})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"assets-business-add"},[a("mu-form",{ref:"assets_business_add",staticClass:"mu-demo-form",attrs:{model:e.formData,"label-position":e.labelPosition,"label-width":"120"}},[a("mu-form-item",{attrs:{prop:"name",label:"业务系统名称",rules:e.nameRules}},[a("mu-text-field",{attrs:{"max-length":50},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),e.is_add?e._e():a("mu-form-item",{attrs:{prop:"status",label:"业务系统状态"}},e._l(e.dropDownData.status,function(t){return a("mu-radio",{key:t.id,attrs:{value:t.id,label:t.name},model:{value:e.formData.status,callback:function(t){e.$set(e.formData,"status",t)},expression:"formData.status"}})}),1),e._v(" "),a("mu-form-item",{attrs:{prop:"description",label:"功能说明",rules:e.descriptionRules}},[a("mu-text-field",{attrs:{"rows-min":2,multiLine:"","rows-max":3,"max-length":500},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1),e._v(" "),a("mu-form-item",{attrs:{prop:"on_time",label:"上线时间",rules:e.on_timeRules}},[a("mu-text-field",{ref:"custom_date_self",attrs:{"max-length":50},on:{click:function(t){return e.openDate("custom_time_picker")}},model:{value:e.formData.on_time,callback:function(t){e.$set(e.formData,"on_time",t)},expression:"formData.on_time"}}),e._v(" "),a("div",{staticClass:"form_date_custom"},[a("el-date-picker",{ref:"custom_time_picker",attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},on:{change:function(t){return e.openDate("custom_date_self")}},model:{value:e.formData.on_time,callback:function(t){e.$set(e.formData,"on_time",t)},expression:"formData.on_time"}})],1)],1),e._v(" "),a("mu-form-item",[e.is_add?e._e():a("mu-button",{attrs:{color:"primary",small:""},on:{click:e.submitEdit}},[e._v("修改")]),e._v(" "),e.is_add?a("mu-button",{attrs:{color:"primary",small:""},on:{click:e.submitAdd}},[e._v("添加")]):e._e(),e._v(" "),e.is_add?a("mu-button",{attrs:{color:"primary",small:""},on:{click:e.submitSaveAdd}},[e._v("保存后继续添加")]):e._e(),e._v(" "),a("mu-button",{attrs:{small:""},on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},staticRenderFns:[]};var u=a("C7Lr")(o,l,!1,function(e){a("s6yE")},"data-v-602e4dad",null).exports,c={data:function(){return{url:"/software/list",type:"get",cloumns:[{type:"selection",fixed:"left"},{type:"index",label:"序号",second_head:{type:"index",width:"60px",label:" ",indexMethod:function(e){return e+1}}},{label:"业务系统名称",sortable:!0,prop:"name",second_head:{width:"200px",prop:"name",templateHeadName:"name_head"}},{label:"业务系统状态",sortable:!0,prop:"status",second_head:{prop:"status",width:"180px",isTemplate:!0,templateName:"status",templateHeadName:"status_head"}},{label:"功能说明",prop:"description",sortable:!0,second_head:{minWidth:"200px",templateHeadName:"description_head",prop:"description"}},{label:"上线时间",prop:"on_time",sortable:!0,second_head:{width:"200px",templateHeadName:"on_time_head",prop:"on_time"}},{label:"退役时间",prop:"off_time",sortable:!0,second_head:{width:"200px",templateHeadName:"off_time_head",prop:"off_time"}},{label:"操作",second_head:{label:"",width:"280px",isTemplate:!0,templateName:"operation"}}],tableHeadShow:!0,params:{page:1,limit:10,name:"",off_time:"",on_time:"",status:"",discript:""},pageParams:{layout:"total, sizes, prev, pager, next, jumper",pageAlign:"left",pageSizes:[10,20,30]},dropDownData:{status:[{id:1,name:"使用中"},{id:2,name:"已退役"}]},selectData:[],icon:{stateIcon:this.$icons.stateIcon}}},methods:{reload:function(){this.$refs.assets_business_table.reload()},search:function(){this.params.page=1,this.reload()},selectChange:function(e){this.selectData=e},add:function(){this.$layer.iframe({content:{content:u,parent:this,data:{dropDownData:this.dropDownData}},area:["500px","auto"],title:"新增业务系统",shadeClose:!1})},edit:function(e){this.$layer.iframe({content:{content:u,parent:this,data:{dropDownData:this.dropDownData,layer_data:e,is_add:!1}},area:["500px","auto"],title:"修改业务系统",shadeClose:!1})},retire:function(e){var t=this;this.$isShowTip("assets","assets_business","确定退役吗?",function(){t.__setRetire({id:e.id})},this)},del:function(e){var t=this,a="";if(Array.isArray(e)){if(this.$tools.isArrayNull(e))return void this.$message({type:"error",message:"请选择需要删除的选项!"});a=this.$tools.mergeId(e)}else a=e.id;this.$isShowTip("assets","assets_business","确定删除吗?",function(){t.__delBusiness({id:a})},this)},__delBusiness:function(e){var t=this;(function(e){return Object(i.a)({url:"/software/del",data:e,type:"post"}).then(function(e){return n.a.resolve(e)}).catch(function(e){return n.a.reject(e)})})(e).then(function(e){t.$message({type:"success",message:"删除成功"}),t.reload()}).catch(function(e){})},__setRetire:function(e){var t=this;(function(e){return Object(i.a)({url:"/software/retire",data:e,type:"post"}).then(function(e){return n.a.resolve(e)}).catch(function(e){return n.a.reject(e)})})(e).then(function(e){t.$message({type:"success",message:"退役成功"}),t.reload()}).catch(function(e){})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"assets-business"},[a("g-el-table",{ref:"assets_business_table",attrs:{tableHeadShow:e.tableHeadShow,url:e.url,type:e.type,cloumns:e.cloumns,params:e.params,pageParams:e.pageParams},on:{selectChange:e.selectChange},scopedSlots:e._u([{key:"table_header",fn:function(){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.add}},[e._v("新增业务系统")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.del(e.selectData)}}},[e._v("批量删除")])]},proxy:!0},{key:"operation",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini",disabled:2==t.data.row.status},on:{click:function(a){return e.retire(t.data.row)}}},[e._v("退役")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.edit(t.data.row)}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.del(t.data.row)}}},[e._v("删除")])]}},{key:"name_head",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"请输入内容",maxLength:20},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}})]}},{key:"status",fn:function(t){return[1==t.data.row.status?a("div",[a("span",{domProps:{innerHTML:e._s(e.icon.stateIcon.success)}}),e._v("使用中\n      ")]):2==t.data.row.status?a("div",[a("span",{domProps:{innerHTML:e._s(e.icon.stateIcon.error)}}),e._v("已退役\n      ")]):e._e()]}},{key:"status_head",fn:function(t){return[a("el-select",{attrs:{clearable:"",size:"mini",placeholder:"请选择"},on:{change:e.search},model:{value:e.params.status,callback:function(t){e.$set(e.params,"status",t)},expression:"params.status"}},e._l(e.dropDownData.status,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)]}},{key:"description_head",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"请输入内容",maxLength:20},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.params.description,callback:function(t){e.$set(e.params,"description",t)},expression:"params.description"}})]}},{key:"on_time_head",fn:function(t){return[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",size:"mini",placeholder:"选择日期","value-format":"yyyy-MM-dd"},on:{change:e.search},model:{value:e.params.on_time,callback:function(t){e.$set(e.params,"on_time",t)},expression:"params.on_time"}})]}},{key:"off_time_head",fn:function(t){return[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",size:"mini",placeholder:"选择日期","value-format":"yyyy-MM-dd"},on:{change:e.search},model:{value:e.params.off_time,callback:function(t){e.$set(e.params,"off_time",t)},expression:"params.off_time"}})]}}])})],1)},staticRenderFns:[]},m=a("C7Lr")(c,d,!1,null,null,null);t.default=m.exports},s6yE:function(e,t){}});
//# sourceMappingURL=18.3aec5ba5bab398862819.js.map