webpackJsonp([33],{coKo:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("HzJ8"),s=a.n(n),r={data:function(){return{url:"/updatelog/list",type:"get",cloumns:[{type:"selection",fixed:"left"},{type:"index",label:"序号",second_head:{type:"index",width:"60px",label:" ",indexMethod:function(e){return e+1}}},{label:"当前版本",sortable:!0,prop:"old_version",second_head:{width:"150px",prop:"old_version",templateHeadName:"old_version_head"}},{label:"更新后版本",sortable:!0,prop:"new_version",second_head:{width:"150px",prop:"new_version",templateHeadName:"new_version_head"}},{label:"对应机器",prop:"ip",sortMethod:this.$tools.IPSort,sortable:!0,second_head:{width:"150px",templateHeadName:"ip_head",prop:"ip"}},{label:"更新包类型",prop:"type",sortable:!0,second_head:{isTemplate:!0,templateName:"type",width:"150px",templateHeadName:"type_head",prop:"type"}},{label:"更新状态",prop:"status",sortable:!0,second_head:{isTemplate:!0,templateName:"status",width:"150px",templateHeadName:"status_head",prop:"status"}},{label:"更新说明",prop:"desc",sortable:!0,second_head:{minWidth:"200px",templateHeadName:"desc_head",prop:"desc"}},{label:"更新时间",prop:"ctime",sortable:!0,second_head:{width:"200px",templateHeadName:"ctime_head",prop:"ctime"}}],tableHeadShow:!0,params:{page:1,limit:10,old_version:"",new_version:"",ip:"",type:"",status:"",desc:"",ctime:""},pageParams:{layout:"total, sizes, prev, pager, next, jumper",pageAlign:"left",pageSizes:[10,20,30]},dropDownData:{type:[{id:1,name:"客户端"},{id:2,name:"服务端"}],status:[{id:1,name:"正在下载"},{id:2,name:"下载成功"},{id:3,name:"下载失败"},{id:4,name:"更新成功"},{id:5,name:"更新失败"}]},icon:{stateIcon:this.$icons.stateIcon},selectData:[]}},methods:{reload:function(){this.$refs.log_refreshlog_table.reload()},search:function(){this.params.page=1,this.reload()},selectChange:function(e){this.selectData=e},exportLog:function(e){if(this.$tools.isArrayNull(e))this.$message({type:"error",message:"请选择要导出的日志选项!"});else{var t="序号,当前版本,更新后版本,对应机器,更新包类型,更新状态,更新说明,更新时间,\n",a=0,n=!0,r=!1,o=void 0;try{for(var i,l=s()(e);!(n=(i=l.next()).done);n=!0){var p=i.value;a++;var d=1==p.type?"客户端":"服务端",c="";switch(p.status){case 1:c="正在下载";break;case 2:c="下载成功";break;case 3:c="下载失败";break;case 4:c="更新成功";break;case 5:c="更新失败"}t+=a+","+p.old_version+","+p.new_version+","+p.ip+","+d+","+c+","+p.desc+","+p.ctime+",\n"}}catch(e){r=!0,o=e}finally{try{!n&&l.return&&l.return()}finally{if(r)throw o}}this.$tools.exportSCV(t,"更新日志")}}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"log-refreshlog"},[a("g-el-table",{ref:"log_refreshlog_table",attrs:{tableHeadShow:e.tableHeadShow,url:e.url,type:e.type,cloumns:e.cloumns,params:e.params,pageParams:e.pageParams},on:{selectChange:e.selectChange},scopedSlots:e._u([{key:"table_header",fn:function(){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.reload}},[e._v("刷新")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.exportLog(e.selectData)}}},[e._v("导出")])]},proxy:!0},{key:"old_version_head",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"请输入内容",maxLength:20},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.params.old_version,callback:function(t){e.$set(e.params,"old_version",t)},expression:"params.old_version"}})]}},{key:"new_version_head",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"请输入内容",maxLength:20},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.params.new_version,callback:function(t){e.$set(e.params,"new_version",t)},expression:"params.new_version"}})]}},{key:"ip_head",fn:function(t){return[a("el-input",{attrs:{maxLength:20,size:"mini",placeholder:"请输入内容"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.params.ip,callback:function(t){e.$set(e.params,"ip",t)},expression:"params.ip"}})]}},{key:"type",fn:function(t){return[e._v(e._s(1==t.data.row.type?"客户端":"服务端"))]}},{key:"type_head",fn:function(t){return[a("el-select",{attrs:{clearable:"",size:"mini",placeholder:"请选择"},on:{change:e.search},model:{value:e.params.type,callback:function(t){e.$set(e.params,"type",t)},expression:"params.type"}},e._l(e.dropDownData.type,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)]}},{key:"status",fn:function(t){return[1==t.data.row.status?a("div",[a("span",{domProps:{innerHTML:e._s(e.icon.stateIcon.pending)}}),e._v("正在下载\n      ")]):2==t.data.row.status?a("div",[a("span",{domProps:{innerHTML:e._s(e.icon.stateIcon.success)}}),e._v("下载成功\n      ")]):3==t.data.row.status?a("div",[a("span",{domProps:{innerHTML:e._s(e.icon.stateIcon.error)}}),e._v("下载失败\n      ")]):4==t.data.row.status?a("div",[a("span",{domProps:{innerHTML:e._s(e.icon.stateIcon.success)}}),e._v("更新成功\n      ")]):5==t.data.row.status?a("div",[a("span",{domProps:{innerHTML:e._s(e.icon.stateIcon.error)}}),e._v("更新失败\n      ")]):e._e()]}},{key:"status_head",fn:function(t){return[a("el-select",{attrs:{clearable:"",size:"mini",placeholder:"请选择"},on:{change:e.search},model:{value:e.params.status,callback:function(t){e.$set(e.params,"status",t)},expression:"params.status"}},e._l(e.dropDownData.status,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)]}},{key:"desc_head",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"请输入内容",maxLength:20},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.params.desc,callback:function(t){e.$set(e.params,"desc",t)},expression:"params.desc"}})]}},{key:"ctime_head",fn:function(t){return[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",size:"mini",placeholder:"选择日期"},on:{change:e.search},model:{value:e.params.ctime,callback:function(t){e.$set(e.params,"ctime",t)},expression:"params.ctime"}})]}}])})],1)},staticRenderFns:[]},i=a("C7Lr")(r,o,!1,null,null,null);t.default=i.exports}});
//# sourceMappingURL=33.1a70c2b24ab697e5d2b1.js.map