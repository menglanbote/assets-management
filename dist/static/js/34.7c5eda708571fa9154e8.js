webpackJsonp([34],{"2zM1":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("HzJ8"),r=a.n(n),s={data:function(){return{url:"/history/list",type:"get",cloumns:[{type:"selection",fixed:"left"},{type:"index",label:"序号",second_head:{type:"index",width:"60px",label:" ",indexMethod:function(e){return e+1}}},{label:"操作用户",sortable:!0,prop:"user_name",second_head:{width:"150px",prop:"user_name",templateHeadName:"user_name_head"}},{label:"操作类型",sortable:!0,prop:"type",second_head:{isTemplate:!0,templateName:"type",width:"150px",prop:"type",templateHeadName:"type_head"}},{label:"操作IP",prop:"ip",sortMethod:this.$tools.IPSort,sortable:!0,second_head:{isTemplate:!0,templateName:"ip",width:"250px",templateHeadName:"ip_head",prop:"ip"}},{label:"操作内容",prop:"content",sortable:!0,second_head:{minWidth:"200px",templateHeadName:"content_head",prop:"content"}},{label:"状态",prop:"status",sortable:!0,second_head:{isTemplate:!0,templateName:"status",width:"150px",templateHeadName:"status_head",prop:"status"}},{label:"操作时间",prop:"ctime",sortable:!0,second_head:{width:"200px",templateHeadName:"ctime_head",prop:"ctime"}}],tableHeadShow:!0,params:{page:1,limit:10,user_name:"",type:"",module_id:"",ip:"",content:"",status:"",ctime:""},pageParams:{layout:"total, sizes, prev, pager, next, jumper",pageAlign:"left",pageSizes:[10,20,30]},dropDownData:{type:[{id:1,name:"用户操作"},{id:2,name:"系统管理"}],module_name:[{id:1,name:"Netfilter服务"}],status:[{id:1,name:"成功"},{id:0,name:"失败"}]},icon:{stateIcon:this.$icons.stateIcon},selectData:[]}},methods:{reload:function(){this.$refs.log_operationlog_table.reload()},search:function(){this.params.page=1,this.reload()},selectChange:function(e){this.selectData=e},exportLog:function(e){if(this.$tools.isArrayNull(e))this.$message({type:"error",message:"请选择要导出的日志选项!"});else{var t="序号,操作用户,操作类型,操作IP,操作内容,状态,操作时间,\n",a=0,n=!0,s=!1,o=void 0;try{for(var l,i=r()(e);!(n=(l=i.next()).done);n=!0){var p=l.value;a++;var c=1==p.type?"用户操作":"系统管理",u=1==p.status?"成功":"失败";t+=a+","+p.user_name+","+c+","+p.ip+","+p.content+","+u+","+p.ctime+",\n"}}catch(e){s=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(s)throw o}}this.$tools.exportSCV(t,"操作日志")}}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"log-operationlog"},[a("g-el-table",{ref:"log_operationlog_table",attrs:{tableHeadShow:e.tableHeadShow,url:e.url,type:e.type,cloumns:e.cloumns,params:e.params,pageParams:e.pageParams},on:{selectChange:e.selectChange},scopedSlots:e._u([{key:"table_header",fn:function(){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.reload}},[e._v("刷新")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.exportLog(e.selectData)}}},[e._v("导出")])]},proxy:!0},{key:"user_name_head",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"请输入内容",maxLength:20},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.params.user_name,callback:function(t){e.$set(e.params,"user_name",t)},expression:"params.user_name"}})]}},{key:"type",fn:function(t){return[e._v(e._s(1==t.data.row.type?"用户操作":"系统管理"))]}},{key:"type_head",fn:function(t){return[a("el-select",{attrs:{clearable:"",size:"mini",placeholder:"请选择"},on:{change:e.search},model:{value:e.params.type,callback:function(t){e.$set(e.params,"type",t)},expression:"params.type"}},e._l(e.dropDownData.type,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)]}},{key:"ip",fn:function(t){return[e._v("\n      "+e._s(t.data.row.ip)+"["+e._s(t.data.row.address)+"]\n    ")]}},{key:"ip_head",fn:function(t){return[a("el-input",{attrs:{maxLength:20,size:"mini",placeholder:"请输入内容"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.params.ip,callback:function(t){e.$set(e.params,"ip",t)},expression:"params.ip"}})]}},{key:"content_head",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"请输入内容",maxLength:20},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.params.content,callback:function(t){e.$set(e.params,"content",t)},expression:"params.content"}})]}},{key:"status",fn:function(t){return[1==t.data.row.status?a("div",[a("span",{domProps:{innerHTML:e._s(e.icon.stateIcon.success)}}),e._v("成功\n      ")]):0==t.data.row.status?a("div",[a("span",{domProps:{innerHTML:e._s(e.icon.stateIcon.error)}}),e._v("失败\n      ")]):e._e()]}},{key:"status_head",fn:function(t){return[a("el-select",{attrs:{clearable:"",size:"mini",placeholder:"请选择"},on:{change:e.search},model:{value:e.params.status,callback:function(t){e.$set(e.params,"status",t)},expression:"params.status"}},e._l(e.dropDownData.status,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)]}},{key:"ctime_head",fn:function(t){return[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",size:"mini",placeholder:"选择日期","value-format":"yyyy-MM-dd"},on:{change:e.search},model:{value:e.params.ctime,callback:function(t){e.$set(e.params,"ctime",t)},expression:"params.ctime"}})]}}])})],1)},staticRenderFns:[]},l=a("C7Lr")(s,o,!1,null,null,null);t.default=l.exports}});
//# sourceMappingURL=34.7c5eda708571fa9154e8.js.map