webpackJsonp([13],{AoI9:function(t,e){},JOSN:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("rVsN"),i=a.n(n),s=a("iqp0");var o={name:"system_managehost_add",data:function(){var t=this;return{labelPosition:"right",ipRules:[{validate:function(t){return!!t},message:"IP地址不能为空"},{validate:function(e){return t.$validates.ipReg.test(e)},message:"请输入正确的IP地址,例如:1.1.1.1"}],formData:{id:"",ip:""}}},props:{layer_data:{type:[Object,Array,Number],default:function(){return{}}},isAdd:{type:Boolean,default:!0},layerid:{type:String}},created:function(){this.isAdd||(this.formData.id=this.layer_data.id,this.formData.ip=this.layer_data.ip)},methods:{submitAdd:function(){var t=this;this.$refs.system_managehost_add.validate().then(function(e){e&&t.$isShowTip("system","system_managehost","确定添加吗？",function(){t.__addIP(t.formData)},t)})},submitEdit:function(){var t=this;this.$refs.system_managehost_add.validate().then(function(e){e&&t.$isShowTip("system","system_managehost","确定修改吗?",function(){t.__editIP(t.formData)},t)})},cancel:function(){var t=this;this.$isShowTip("system","system_managehost","确定取消吗？",function(){t.$layer.close(t.layerid)},this)},__addIP:function(t){var e=this;(function(t){return Object(s.a)({url:"/allowip/add",data:t,type:"post"}).then(function(t){return i.a.resolve(t)}).catch(function(t){return i.a.reject(t)})})(t).then(function(t){e.$message({type:"success",message:"添加成功"}),e.$layer.close(e.layerid),e.$parent.$refs.system_managehost_table.reload()}).catch(function(t){})},__editIP:function(t){var e=this;(function(t){return Object(s.a)({url:"/allowip/modify",data:t,type:"post"}).then(function(t){return i.a.resolve(t)}).catch(function(t){return i.a.reject(t)})})(t).then(function(t){e.$message({type:"success",message:"修改成功"}),e.$layer.close(e.layerid),e.$parent.$refs.system_managehost_table.reload()}).catch(function(t){})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"system-managehost-add"},[a("mu-form",{ref:"system_managehost_add",staticClass:"mu-demo-form",attrs:{model:t.formData,"label-position":t.labelPosition,"label-width":"80"}},[a("mu-form-item",{attrs:{prop:"ip",label:"IP地址",rules:t.ipRules}},[a("mu-text-field",{attrs:{"max-length":50},model:{value:t.formData.ip,callback:function(e){t.$set(t.formData,"ip",e)},expression:"formData.ip"}})],1),t._v(" "),a("mu-form-item",[t.isAdd?a("mu-button",{attrs:{color:"primary",small:""},on:{click:t.submitAdd}},[t._v("添加")]):t._e(),t._v(" "),t.isAdd?t._e():a("mu-button",{attrs:{color:"primary",small:""},on:{click:t.submitEdit}},[t._v("修改")]),t._v(" "),a("mu-button",{attrs:{small:""},on:{click:t.cancel}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]};var l=a("C7Lr")(o,r,!1,function(t){a("AoI9")},"data-v-bf3b9568",null).exports,c=a("4fsh"),m={name:"system_managehost_configset",data:function(){return{labelPosition:"right",formData:{status:"1",time_range:"0",type:"ipWhiteSetting"},dropDownData:{status:[{id:"1",name:"自动添加"},{id:"0",name:"人工添加"}],time_range:[{id:"0",name:"永久"},{id:"1",name:"30分钟"},{id:"2",name:"1小时"},{id:"3",name:"8小时"},{id:"4",name:"16小时"}]}}},props:{layer_data:{type:[Object,Array,Number],default:function(){return{}}},isconfigset:{type:Boolean,default:!0},layerid:{type:String}},created:function(){this.__getConfig({type:"ipWhiteSetting"})},methods:{submitEdit:function(){var t=this;this.$refs.system_managehost_configset.validate().then(function(e){e&&t.$isShowTip("system","system_managehost","确定提交吗?",function(){t.__setConfig(t.formData)},t)})},cancel:function(){var t=this;this.$isShowTip("system","system_managehost","确定取消吗？",function(){t.$layer.close(t.layerid)},this)},__getConfig:function(t){var e=this;Object(c.a)(t).then(function(t){e.formData.status=t.data.status||"1",e.formData.time_range=t.data.time_range||"0"}).catch(function(t){})},__setConfig:function(t){var e=this;Object(c.c)(t).then(function(t){e.$message({type:"success",message:"设置成功"}),e.$layer.close(e.layerid)}).catch(function(t){})}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"system-managehost-configset"},[a("mu-form",{ref:"system_managehost_configset",staticClass:"mu-demo-form",attrs:{model:t.formData,"label-position":t.labelPosition,"label-width":"100"}},[a("el-divider",{attrs:{"content-position":"left"}},[t._v("白名单模式")]),t._v(" "),a("mu-form-item",{attrs:{prop:"status",label:"工作模式"}},t._l(t.dropDownData.status,function(e){return a("mu-radio",{key:e.id,attrs:{value:e.id,label:e.name},model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}})}),1),t._v(" "),a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:1==t.formData.status,expression:"formData.status == 1"}]},[a("el-divider",{attrs:{"content-position":"left"}},[t._v("时间范围")]),t._v(" "),a("mu-form-item",{attrs:{prop:"time_range",label:"功能生效期"}},t._l(t.dropDownData.time_range,function(e){return a("mu-radio",{key:e.id,attrs:{value:e.id,label:e.name},model:{value:t.formData.time_range,callback:function(e){t.$set(t.formData,"time_range",e)},expression:"formData.time_range"}})}),1)],1)]),t._v(" "),a("mu-form-item",[a("mu-button",{attrs:{color:"primary",small:""},on:{click:t.submitEdit}},[t._v("提交")]),t._v(" "),a("mu-button",{attrs:{small:""},on:{click:t.cancel}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]};var d=a("C7Lr")(m,u,!1,function(t){a("h9M6")},"data-v-25d09cca",null).exports,f={data:function(){return{url:"/allowip/list",type:"get",cloumns:[{type:"selection",fixed:"left"},{type:"index",label:"序号",second_head:{type:"index",width:"60px",label:" ",indexMethod:function(t){return t+1}}},{label:"IP地址",sortable:!0,prop:"ip",sortMethod:this.$tools.IPSort,second_head:{prop:"ip",width:"200px",templateHeadName:"ip_head"}},{label:"上次登录时间",prop:"login_time",sortable:!0,second_head:{width:"200px",templateHeadName:"login_time_head",prop:"login_time"}},{label:"操作",second_head:{label:"",minWidth:"100px",isTemplate:!0,templateName:"operation"}}],tableHeadShow:!0,params:{page:1,limit:10,ip:"",login_time:""},pageParams:{layout:"total, sizes, prev, pager, next, jumper",pageAlign:"left",pageSizes:[10,20,30]},selectData:[]}},methods:{reload:function(){this.$refs.system_managehost_table.reload()},search:function(){this.params.page=1,this.reload()},selectChange:function(t){this.selectData=t},configSet:function(){this.$layer.iframe({content:{content:d,parent:this,data:{}},area:["600px","auto"],title:"功能设置",shadeClose:!1})},add:function(){this.$layer.iframe({content:{content:l,parent:this,data:{}},area:["350px","auto"],title:"增加IP地址",shadeClose:!1})},edit:function(t){this.$layer.iframe({content:{content:l,parent:this,data:{layer_data:t,isAdd:!1}},area:["350px","auto"],title:"修改IP地址",shadeClose:!1})},del:function(t){var e=this,a="";if(Array.isArray(t)){if(this.$tools.isArrayNull(t))return void this.$message({type:"error",message:"请选择需要删除的选项!"});a=this.$tools.mergeId(t)}else a=t.id;this.$isShowTip("system","system_managehost","确定删除吗?",function(){e.__delIP({id:a})},this)},__delIP:function(t){var e=this;(function(t){return Object(s.a)({url:"/allowip/del",data:t,type:"post"}).then(function(t){return i.a.resolve(t)}).catch(function(t){return i.a.reject(t)})})(t).then(function(t){e.$message({type:"success",message:"删除成功"}),e.reload()}).catch(function(t){})}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"system-managehost"},[a("g-el-table",{ref:"system_managehost_table",attrs:{tableHeadShow:t.tableHeadShow,url:t.url,type:t.type,cloumns:t.cloumns,params:t.params,pageParams:t.pageParams},on:{selectChange:t.selectChange},scopedSlots:t._u([{key:"table_header",fn:function(){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.add}},[t._v("增加IP")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.configSet}},[t._v("功能设置")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.del(t.selectData)}}},[t._v("批量删除")])]},proxy:!0},{key:"operation",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.edit(e.data.row)}}},[t._v("编辑")])]}},{key:"ip_head",fn:function(e){return[a("el-input",{attrs:{maxLength:20,size:"mini",placeholder:"请输入内容"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.params.ip,callback:function(e){t.$set(t.params,"ip",e)},expression:"params.ip"}})]}},{key:"login_time_head",fn:function(e){return[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",size:"mini",placeholder:"选择日期"},on:{change:t.search},model:{value:t.params.login_time,callback:function(e){t.$set(t.params,"login_time",e)},expression:"params.login_time"}})]}}])})],1)},staticRenderFns:[]},h=a("C7Lr")(f,p,!1,null,null,null);e.default=h.exports},h9M6:function(t,e){}});
//# sourceMappingURL=13.58c34dbf0531920bc2af.js.map